<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>twitter</title>
</head>
<body>

<script>

/*
     Consumer Key (API Key): lU0qgBsyzBT68aTCOQYZGQAXe
     Consumer Secret (API Secret): lNAprXvTJMAgN5QMAcldVmfz7hZ6k8I6Mad2VB6tbgoqcmyxvw

     Access Token: 546738866-t8H5a6sy3zCnmKjIvgFVwo1MELhYQwhDsACsYouj
     Access Token Secret: cAjacsL9n6x0prIQIZJgEDJKe49KebAaCKWCLiUFKYkV4



    var optionsSignature = {
        oauth_consumer_key: "lU0qgBsyzBT68aTCOQYZGQAXe",
        oauth_nonce: "lNAprXvTJMAgN5QMAcldVmfz7hZ6k8I6Mad2VB6tbgoqcmyxvw",
        oauth_signature_method: "HMAC-SHA1",
        oauth_timestamp: "1318622958",
        oauth_token: "546738866-t8H5a6sy3zCnmKjIvgFVwo1MELhYQwhDsACsYouj",
        oauth_version: "1.0",
        status: "Hello Ladies+Gentlemen, a signed OAuth request!"
    };
*/

    var primOotionsSignature = {
        include_entities: true,
        oauth_consumer_key: "xvz1evFS4wEEPTGEFPHBog",
        oauth_nonce: "kYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg",
        oauth_signature_method: "HMAC-SHA1",
        oauth_timestamp: "1318622958",
        oauth_token: "370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb",
        oauth_version: "1.0",
        status: "Hello Ladies + Gentlemen, a signed OAuth request!"
    };


function percentEncode(str) {
    return encodeURIComponent(str).replace(/[!*()']/g, function (character) {
        return '%' + character.charCodeAt(0).toString(16);
    });
}

//String.fromCharCode(parseInt('6'.charCodeAt(0).toString(16), 16))

    function encode(object) {
        return Object
                .keys(object).reduce(function (result, key) {
                    result[percentEncode(key)] = percentEncode(object[key]);
                    return result;
                }, {});
    }


    console.log(encode(primOotionsSignature));


    function stringParameter(object) {

        return  Object
            .keys(object)
            .sort()
            .map( function (key) {
                var value = object[key];
                return  key + "=" + value;
            })
            .join("&");

    }

    console.log("Parameter string: " + stringParameter(encode(primOotionsSignature)));

    function signatureHTTPSString() {
        var HTTPStr = "https://api.twitter.com/1.1/statuses/update.json";
        //HTTPStr.toUpperCase();
        return "POST&" + percentEncode(HTTPStr) + "&";
        //return percentEncode("POST" + HTTPStr + "&");
    }

    //console.log( signatureHTTPSString() );

    function signatureBaseString() {
        return signatureHTTPSString() + percentEncode(stringParameter(encode(primOotionsSignature)));
    }


    var SignatureBseString = signatureBaseString();

    console.log("Signature base string: " + SignatureBseString );

/*
М POST&https%3A%2F%2Fapi.twitter.com%2F1.1%2Fstatuses%2Fupdate.json&include_entities%3Dtrue%26oauth_consumer_key%3Dxvz1evFS4wEEPTGEFPHBog%26oauth_nonce%3DkYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1318622958%26oauth_token%3D370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb%26oauth_version%3D1.0%26status%3DHello%2520Ladies%2520%252B%2520Gentlemen%252C%2520a%2520signed%2520OAuth%2520request%2521
П POST&https%3A%2F%2Fapi.twitter.com%2F1.1%2Fstatuses%2Fupdate.json&include_entities%3Dtrue%26oauth_consumer_key%3Dxvz1evFS4wEEPTGEFPHBog%26oauth_nonce%3DkYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1318622958%26oauth_token%3D370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb%26oauth_version%3D1.0%26status%3DHello%2520Ladies%2520%252B%2520Gentlemen%252C%2520a%2520signed%2520OAuth%2520request%2521
 */





    // Consumer Secret (API Secret):	lNAprXvTJMAgN5QMAcldVmfz7hZ6k8I6Mad2VB6tbgoqcmyxvw
    // Token Secret:	cAjacsL9n6x0prIQIZJgEDJKe49KebAaCKWCLiUFKYkV4

    var secretObj = {
        //ConsumerSecret: "lNAprXvTJMAgN5QMAcldVmfz7hZ6k8I6Mad2VB6tbgoqcmyxvw",
        //TokenSecret: "cAjacsL9n6x0prIQIZJgEDJKe49KebAaCKWCLiUFKYkV4"
        ConsumerSecret: "kAcSOqF21Fu85e7zjz7ZN2U4ZRhfV3WpwPAoE3Z7kBw",
        OAuthTokenSecret: "LswwdoUaIvS8ltyTt5jkRh4J50vUPVVHtR2YPi5kE"
    };

    function getSigningKey(object) {
        return Object
            .keys(object)
            .map( function (item) {
                value = object[item];
                return percentEncode(value);
            })
            .join("&");
    }
    var key = getSigningKey(secretObj);
    console.log("Signing key: " + key );

/*
П kAcSOqF21Fu85e7zjz7ZN2U4ZRhfV3WpwPAoE3Z7kBw&LswwdoUaIvS8ltyTt5jkRh4J50vUPVVHtR2YPi5kE
М kAcSOqF21Fu85e7zjz7ZN2U4ZRhfV3WpwPAoE3Z7kBw&LswwdoUaIvS8ltyTt5jkRh4J50vUPVVHtR2YPi5kE
*/

    /*
    function get(object) {
        var keyInObj = Object.keys(object);
        console.log("ключи " + keyInObj);

        var valueInObj = Object.keys(object)
            .map(function (key) {
               return object[key];
            });
        console.log("значения ключей " + valueInObj);

        var encodeKeyInObj = [];
        for (var i = 0; i < keyInObj.length; i++ ) {
            encodeKeyInObj[i] = encodeURIComponent(keyInObj[i]);
        }

        console.log("Закодированные ключи по алфавиту " + encodeKeyInObj.sort());

        var encodeValueInObj = [];
        for (var j = 0; j < valueInObj.length; j++ ) {
            encodeValueInObj[j] = encodeURIComponent(valueInObj[j]);
        }

        console.log("Закодированные значения по алфавиту " + encodeValueInObj.sort());

        var resultObject = {};
        var keyInResultObject =
        var valueInResultObject =

    }

    get(obj);
    */
    /*

    function stringParameter(object) {
        var sortKeys =  Object
                .keys(object)
                .sort();

        var sortProp = Object
                .keys(object)
                .map(function (key) {
                   sortKeys[key].reduce(function (previousItem, item) {
                       return previousItem + obj[item];
                   }, 0);
                });

        //console.log(sortKeys);
        //console.log(sortProp);
    */
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
<script type="text/javascript">

   var sssss = percentEncode(CryptoJS.HmacSHA1(SignatureBseString, key).toString());

   console.log("OAuth signature: " + sssss );
   var words = CryptoJS.enc.Hex.parse(sssss);
   var base64 = CryptoJS.enc.Base64.stringify(words);
   console.log("OAuth signature: " + base64);

    /*
    м hCtSmYh+iHYCEqBWrE7C7hYmtUk=
    п hCtSmYh+iHYCEqBWrE7C7hYmtUk=
     */

</script>
</body>
</html>